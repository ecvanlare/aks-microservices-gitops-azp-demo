# Service Definitions for Online Boutique
# This template sets service-related variables for use in other templates

steps:
  # Set service list for easy iteration
  - script: |
      echo "##vso[task.setvariable variable=ALL_SERVICES]cartservice,frontend,productcatalogservice,currencyservice,emailservice,paymentservice,shippingservice,recommendationservice,adservice,checkoutservice,shoppingassistantservice"
    displayName: 'Set Service List'
    name: SetServiceList

  # Set service-related variables
  - script: |
      echo "Setting service definitions as variables..."
      
      # Set individual service configurations as JSON strings
      echo "##vso[task.setvariable variable=CARTSERVICE_CONFIG]{\"name\":\"cartservice\",\"path\":\"src/cartservice/\",\"dockerfile\":\"src/cartservice/src/Dockerfile\",\"context\":\"src/cartservice/src\",\"dependencies\":[],\"description\":\"Shopping cart service\"}"
      echo "##vso[task.setvariable variable=FRONTEND_CONFIG]{\"name\":\"frontend\",\"path\":\"src/frontend/\",\"dockerfile\":\"src/frontend/Dockerfile\",\"context\":\"src/frontend\",\"dependencies\":[],\"description\":\"Web frontend application\"}"
      echo "##vso[task.setvariable variable=PRODUCTCATALOGSERVICE_CONFIG]{\"name\":\"productcatalogservice\",\"path\":\"src/productcatalogservice/\",\"dockerfile\":\"src/productcatalogservice/Dockerfile\",\"context\":\"src/productcatalogservice\",\"dependencies\":[],\"description\":\"Product catalog service\"}"
      echo "##vso[task.setvariable variable=CURRENCYSERVICE_CONFIG]{\"name\":\"currencyservice\",\"path\":\"src/currencyservice/\",\"dockerfile\":\"src/currencyservice/Dockerfile\",\"context\":\"src/currencyservice\",\"dependencies\":[],\"description\":\"Currency conversion service\"}"
      echo "##vso[task.setvariable variable=EMAILSERVICE_CONFIG]{\"name\":\"emailservice\",\"path\":\"src/emailservice/\",\"dockerfile\":\"src/emailservice/Dockerfile\",\"context\":\"src/emailservice\",\"dependencies\":[],\"description\":\"Email notification service\"}"
      echo "##vso[task.setvariable variable=PAYMENTSERVICE_CONFIG]{\"name\":\"paymentservice\",\"path\":\"src/paymentservice/\",\"dockerfile\":\"src/paymentservice/Dockerfile\",\"context\":\"src/paymentservice\",\"dependencies\":[],\"description\":\"Payment processing service\"}"
      echo "##vso[task.setvariable variable=SHIPPINGSERVICE_CONFIG]{\"name\":\"shippingservice\",\"path\":\"src/shippingservice/\",\"dockerfile\":\"src/shippingservice/Dockerfile\",\"context\":\"src/shippingservice\",\"dependencies\":[],\"description\":\"Shipping calculation service\"}"
      echo "##vso[task.setvariable variable=RECOMMENDATIONSERVICE_CONFIG]{\"name\":\"recommendationservice\",\"path\":\"src/recommendationservice/\",\"dockerfile\":\"src/recommendationservice/Dockerfile\",\"context\":\"src/recommendationservice\",\"dependencies\":[\"productcatalogservice\"],\"description\":\"Product recommendation service\"}"
      echo "##vso[task.setvariable variable=ADSERVICE_CONFIG]{\"name\":\"adservice\",\"path\":\"src/adservice/\",\"dockerfile\":\"src/adservice/Dockerfile\",\"context\":\"src/adservice\",\"dependencies\":[],\"description\":\"Advertisement service\"}"
      echo "##vso[task.setvariable variable=CHECKOUTSERVICE_CONFIG]{\"name\":\"checkoutservice\",\"path\":\"src/checkoutservice/\",\"dockerfile\":\"src/checkoutservice/Dockerfile\",\"context\":\"src/checkoutservice\",\"dependencies\":[\"cartservice\",\"paymentservice\"],\"description\":\"Checkout processing service\"}"
      echo "##vso[task.setvariable variable=SHOPPINGASSISTANTSERVICE_CONFIG]{\"name\":\"shoppingassistantservice\",\"path\":\"src/shoppingassistantservice/\",\"dockerfile\":\"src/shoppingassistantservice/Dockerfile\",\"context\":\"src/shoppingassistantservice\",\"dependencies\":[],\"description\":\"Shopping assistant service\"}"
      
      echo "Service definitions set successfully"
    displayName: 'Set Service Definitions'
    name: SetServiceDefinitions 